<!DOCTYPE html>
<html lang="vi-VN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X√°c nh·∫≠n th√¥ng tin kh√°ch m·ªùi</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Muli:wght@400;600&family=Playfair+Display:wght@400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- Background Music -->
    <audio id="background-music" loop>
        <source src="music/wedding-song.mp3" type="audio/mpeg">
    </audio>

    <div class="container">
        <!-- Header Section -->
        <section class="header-section">
            <!-- Flower decoration top left -->
            <img src="images/bg0001.png" alt="Flower decoration" class="flower-decoration flower-top-left"
                loading="lazy">

            <!-- Bride & Groom Photo -->
            <div style="position: relative;">
                <img src="images/6-TED_9270.jpg" alt="Minh H·∫£o & Phi Ta" class="bride-groom-photo" loading="lazy"
                    width="300" height="400"
                    onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div
                    style="display:none; width:300px; height:400px; border-radius:8px; background:linear-gradient(135deg, #8b4f4f 0%, #5a3030 100%); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); flex-shrink:0; position:relative;">
                    <div
                        style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); color:#fff; font-size:11px; text-align:center; padding:10px;">
                        Th√™m ·∫£nh<br>6-TED_9270.jpg
                    </div>
                </div>
            </div>

            <div class="header-content">
                <h1 class="couple-names">
                    Minh H·∫£o<br>
                    & Phi Ta
                </h1>
                <div class="wedding-info">
                    22 th√°ng 11 nƒÉm 2025 | 11 gi·ªù tr∆∞a<br>
                    T·∫°i nh√† h√†ng ti·ªác c∆∞·ªõi Ti·∫øn ƒê∆∞·ª£c<br>
                    <a href="https://maps.app.goo.gl/bxtFLvYh7RKKyudH7" target="_blank" rel="noopener noreferrer"
                        class="map-link">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            style="vertical-align: middle; margin-right: 4px;">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        Xem b·∫£n ƒë·ªì
                    </a>
                </div>
            </div>

            <!-- Flower decoration top right -->
            <img src="images/bg0002.png" alt="Flower decoration" class="flower-decoration flower-top-right"
                loading="lazy" width="344" height="209">
        </section>

        <!-- Story Section -->
        <section class="story-section">
            <div class="story-header">
                <!-- Flower left -->
                <img src="images/bg0004.png" alt="Flower decoration" class="flower-left" loading="lazy" width="160"
                    height="143">

                <h2 class="story-title">üåø H√†nh tr√¨nh mang t√™n "Ch√∫ng m√¨nh"</h2>
            </div>

            <div class="story-wrapper">
                <div class="story-content">
                    <p class="story-text">
                        T·ª´ nh·ªØng ng√†y ƒë·∫ßu c√≤n b·ª° ng·ª° cho ƒë·∫øn khi quen thu·ªôc t·ª´ng √°nh nh√¨n, Phi Ta & Minh H·∫£o ƒë√£ c√πng
                        nhau ƒëi qua h∆°n m∆∞·ªùi th√°ng ƒë·∫ßy y√™u th∆∞∆°ng v√† s·∫ª chia.
                        Gi·ªØa mu√¥n v√†n ƒëi·ªÅu b√¨nh th∆∞·ªùng, h·ªç t√¨m th·∫•y nhau - gi·∫£n d·ªã nh∆∞ng l·∫°i th·∫≠t ƒë√∫ng ng∆∞·ªùi.
                    </p>
                    <p class="story-text">
                        Gi·ªù ƒë√¢y, hai tr√°i tim ·∫•y quy·∫øt ƒë·ªãnh c√πng nhau b∆∞·ªõc sang m·ªôt ch∆∞∆°ng m·ªõi, v·ªõi ni·ªÅm tin v√† t√¨nh y√™u
                        lu√¥n ƒëong ƒë·∫ßy.
                        Mong b·∫°n s·∫Ω c√πng ƒë·∫øn, ƒë·ªÉ chia vui v√† ch·ª©ng ki·∫øn kho·∫£nh kh·∫Øc √Ω nghƒ©a nh·∫•t c·ªßa t·ª•i m√¨nh.
                    </p>
                </div>

                <!-- Flower right -->
                <img src="images/bg0003.png" alt="Flower decoration" class="flower-right" loading="lazy" width="160"
                    height="143">
            </div>
        </section>

        <!-- Gallery Section -->
        <section class="gallery-section">
            <div class="gallery-grid">
                <!-- Photo 1 -->
                <div style="position:relative;">
                    <img src="images/7-TED_9222.jpg" alt="·∫¢nh c∆∞·ªõi truy·ªÅn th·ªëng" class="gallery-item" loading="lazy"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="gallery-item"
                        style="display:none; align-items:center; justify-content:center; color:#999; font-size:12px; text-align:center; padding:20px;">
                        Th√™m ·∫£nh<br>7-TED_9222.jpg
                    </div>
                </div>

                <!-- Photo 2 -->
                <div style="position:relative;">
                    <img src="images/11-TED_8800.jpg" alt="·∫¢nh c∆∞·ªõi ph∆∞∆°ng T√¢y" class="gallery-item" loading="lazy"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="gallery-item"
                        style="display:none; align-items:center; justify-content:center; color:#999; font-size:12px; text-align:center; padding:20px;">
                        Th√™m ·∫£nh<br>11-TED_8800.jpg
                    </div>
                </div>

                <!-- Photo 3 -->
                <div style="position:relative;">
                    <img src="images/12-TED_8621.jpg" alt="·∫¢nh c∆∞·ªõi ph∆∞∆°ng T√¢y" class="gallery-item" loading="lazy"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="gallery-item"
                        style="display:none; align-items:center; justify-content:center; color:#999; font-size:12px; text-align:center; padding:20px;">
                        Th√™m ·∫£nh<br>12-TED_8621.jpg
                    </div>
                </div>
            </div>
        </section>



        <!-- Guest Information Form Section -->
        <section class="form-section">
            <!-- Flower decoration top left -->
            <img src="images/bg0010.png" alt="Flower decoration" class="form-flower-left" loading="lazy">

            <!-- Flower decoration top right -->
            <img src="images/bg0005.png" alt="Flower decoration" class="form-flower-right" loading="lazy">

            <div class="form-container">
                <h2 class="form-title">X√°c nh·∫≠n th√¥ng tin kh√°ch m·ªùi</h2>
                <p class="form-subtitle">Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin ƒë·ªÉ ch√∫ng t√¥i chu·∫©n b·ªã chu ƒë√°o h∆°n</p>

                <script type="text/javascript">
                    var submitted = false;
                </script>
                <iframe id="hidden_iframe" name="hidden_iframe" style="display: none;"></iframe>

                <form id="guest-form" onsubmit="submitted=true;" target="hidden_iframe" method="GET"
                    action="https://script.google.com/macros/s/AKfycbyWpLhX2NXATxfPbbMjgej8r_Dux1cFjXYQGZ7Lq6ZDFRwbaSi7KK_trR04fNd46Hi9Iw/exec">
                    <!-- Full Name -->
                    <div class="form-group">
                        <label class="form-label">H·ªç v√† t√™n <span style="color: #d4394d;">*</span></label>
                        <input type="text" class="form-input" name="H·ªç v√† t√™n" placeholder="Nh·∫≠p h·ªç v√† t√™n c·ªßa b·∫°n"
                            required>
                    </div>

                    <!-- Phone Number -->
                    <div class="form-group">
                        <label class="form-label">S·ªë ƒëi·ªán tho·∫°i <span style="color: #d4394d;">*</span></label>
                        <input type="tel" class="form-input" name="S·ªë ƒëi·ªán tho·∫°i" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"
                            pattern="[0-9\-\+\s\(\)]*" required>
                    </div>

                    <!-- Number of Guests -->
                    <div class="form-group">
                        <label class="form-label">S·ªë l∆∞·ª£ng kh√°ch <span style="color: #d4394d;">*</span></label>
                        <select class="form-select" name="S·ªë l∆∞·ª£ng kh√°ch" required>
                            <option value="">-- Ch·ªçn s·ªë l∆∞·ª£ng kh√°ch --</option>
                            <option value="1 ng∆∞·ªùi">1 ng∆∞·ªùi</option>
                            <option value="2 ng∆∞·ªùi">2 ng∆∞·ªùi</option>
                            <option value="H∆°n 2 ng∆∞·ªùi">H∆°n 2 ng∆∞·ªùi</option>
                        </select>
                    </div>

                    <!-- Transportation -->
                    <div class="form-group">
                        <label class="form-label">Ph∆∞∆°ng ti·ªán di chuy·ªÉn <span style="color: #d4394d;">*</span></label>
                        <div class="form-radio-group">
                            <div class="form-radio">
                                <input type="radio" name="Ph∆∞∆°ng ti·ªán di chuy·ªÉn" value="C√¥ d√¢u s·∫Øp x·∫øp xe" required>
                                <label>C√¥ d√¢u s·∫Øp x·∫øp xe</label>
                            </div>
                            <div class="form-radio">
                                <input type="radio" name="Ph∆∞∆°ng ti·ªán di chuy·ªÉn" value="T·ª± t√∫c">
                                <label>T·ª± t√∫c</label>
                            </div>
                            <div class="form-radio">
                                <input type="radio" name="Ph∆∞∆°ng ti·ªán di chuy·ªÉn" value="Kh√°c">
                                <label>Kh√°c</label>
                            </div>
                        </div>
                    </div>

                    <!-- Special Requests -->
                    <div class="form-group">
                        <label class="form-label">Y√™u c·∫ßu ƒë·∫∑c bi·ªát (t√πy ch·ªçn)</label>
                        <textarea class="form-input" name="Y√™u c·∫ßu ƒë·∫∑c bi·ªát"
                            placeholder="V√≠ d·ª•: B·∫°n c√≥ y√™u c·∫ßu v·ªÅ th·ª±c ph·∫©m, gh·∫ø ng·ªìi hay b·∫•t c·ª© th·ª© g√¨ kh√°c..."
                            style="resize: vertical; min-height: 100px; font-family: 'Muli', sans-serif;"></textarea>
                    </div>

                    <!-- Submit Button -->
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="submit" class="form-submit">X√°c nh·∫≠n tham d·ª±</button>
                    </div>

                    <!-- Congratulations Button -->
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="button" id="congratulations-btn" class="congratulations-btn">M·ª™NG C∆Ø·ªöI</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- RSVP Section -->
        <section class="rsvp-section">
            <!-- Flower top right -->
            <img src="images/bg0007.png" alt="Flower decoration" class="rsvp-flower-top" loading="lazy">

            <!-- Flower bottom left -->
            <img src="images/bg0006.png" alt="Flower decoration" class="rsvp-flower-bottom" loading="lazy">

            <div class="rsvp-content">
                <h2 class="rsvp-title">
                    S·ª± hi·ªán di·ªán c·ªßa <span id="guest-title-1">b·∫°n</span> ƒë√£ l√† m·ªôt m√≥n qu√† v√¥ gi√°!
                </h2>

                <p class="rsvp-text">
                    ƒêi·ªÅu √Ω nghƒ©a nh·∫•t l√† ƒë∆∞·ª£c chia s·∫ª ng√†y h·∫°nh ph√∫c n√†y c√πng <span id="guest-title-2">b·∫°n</span>.<br>
                    L·ªùi ch√∫c ph√∫c ch√¢n th√†nh c·ªßa <span id="guest-title-3">b·∫°n</span> ch√≠nh l√† m√≥n qu√† qu√Ω gi√° nh·∫•t<br>
                    m√† ch√∫ng t√¥i mong mu·ªën nh·∫≠n ƒë∆∞·ª£c
                </p>

                <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-bottom: 20px;">
                    <a href="/wedding/gallery.html" class="rsvp-button">XEM KHO·∫¢NH KH·∫ÆC ƒê·∫∏P</a>
                </div>
            </div>

            <!-- Leaf bottom right -->
            <img src="images/bg0008.png" alt="Leaf decoration" class="rsvp-leaf-right" loading="lazy">
        </section>
    </div>

    <!-- Modal Notification -->
    <div id="notification-modal" class="modal">
        <div class="modal-content">
            <div class="modal-body">
                <!-- Loading State -->
                <div id="loading-state" class="modal-state">
                    <div class="spinner"></div>
                    <p class="modal-text">ƒêang x·ª≠ l√Ω...</p>
                </div>

                <!-- Success State -->
                <div id="success-state" class="modal-state" style="display: none;">
                    <div class="success-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                    </div>
                    <h3 class="modal-title">C·∫£m ∆°n b·∫°n!</h3>
                    <p class="modal-text">Ch√∫ng t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c x√°c nh·∫≠n c·ªßa b·∫°n.<br>S·∫Ω s·ªõm li√™n h·ªá v·ªõi b·∫°n.</p>
                </div>

                <!-- Error State -->
                <div id="error-state" class="modal-state" style="display: none;">
                    <div class="error-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="15" y1="9" x2="9" y2="15"></line>
                            <line x1="9" y1="9" x2="15" y2="15"></line>
                        </svg>
                    </div>
                    <h3 class="modal-title">C√≥ l·ªói x·∫£y ra</h3>
                    <p class="modal-text" id="error-message">Vui l√≤ng th·ª≠ l·∫°i ho·∫∑c g·ªçi 0935523473</p>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Code Modal -->
    <div id="qr-modal" class="modal">
        <div class="modal-content qr-modal-content">
            <div class="modal-body">
                <div class="qr-modal-header">
                    <h3 class="modal-title">M·ª´ng c∆∞·ªõi c√¥ d√¢u Minh H·∫£o ‚ù§Ô∏è</h3>
                    <button id="qr-modal-close" class="qr-modal-close-btn">&times;</button>
                </div>
                <div class="qr-content">
                    <div class="qr-image-container">
                        <img src="images/qr-code.jpg" alt="QR Code m·ª´ng c∆∞·ªõi" class="qr-code-image" 
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <div class="qr-placeholder" style="display:none; width:200px; height:200px; border-radius:8px; background:linear-gradient(135deg, #8b4f4f 0%, #5a3030 100%); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); flex-shrink:0; position:relative;">
                            <div style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); color:#fff; font-size:12px; text-align:center; padding:10px;">
                                Th√™m ·∫£nh QR code<br>images/qr-code.jpg
                            </div>
                        </div>
                    </div>
                    <p class="qr-description">
                        Qu√©t m√£ QR ƒë·ªÉ g·ª≠i l·ªùi ch√∫c m·ª´ng v√† qu√† m·ª´ng c∆∞·ªõi ƒë·∫øn c√¥ d√¢u <strong>Minh H·∫£o üòò</strong> 
                    </p>
                </div>
            </div>
        </div>
    </div>    <script>
        // Get URL parameters
        function getUrlParameter(name) {
            const queryString = window.location.search.substring(1);
            const params = queryString.split('&');
            for (let param of params) {
                const [key, value] = param.split('=');
                if (key === name) {
                    return decodeURIComponent(value);
                }
            }
            return '';
        }

        // Music control - Play only on user interaction
        let musicStarted = false;
        let music = null;

        function startBackgroundMusic(event) {
            if (musicStarted) return;

            console.log('User interaction detected:', event.type);

            if (!music) {
                music = document.getElementById('background-music');
            }

            if (music) {
                // Load the audio first
                music.load();

                music.play()
                    .then(() => {
                        console.log('‚úì Music started successfully');
                        musicStarted = true;
                        // Remove all event listeners after music starts
                        document.removeEventListener('click', startBackgroundMusic, true);
                        document.removeEventListener('touchstart', startBackgroundMusic, true);
                        document.removeEventListener('touchend', startBackgroundMusic, true);
                        document.removeEventListener('mousedown', startBackgroundMusic, true);
                    })
                    .catch(err => {
                        console.error('‚úó Failed to start music:', err.name, err.message);
                        musicStarted = false;
                    });
            } else {
                console.error('‚úó Music element not found');
            }
        }

        // Wait for DOM to be ready, then attach listeners
        document.addEventListener('DOMContentLoaded', function () {
            music = document.getElementById('background-music');
            if (music) {
                music.volume = 0.3; // Set volume to 30%
                console.log('Music element loaded, volume set to 30%');

                // Only attach DIRECT user interaction events (not scroll/mousemove)
                // These are the ONLY events browsers consider as "user gesture"
                document.addEventListener('click', startBackgroundMusic, true);
                document.addEventListener('touchstart', startBackgroundMusic, true);
                document.addEventListener('touchend', startBackgroundMusic, true);
                document.addEventListener('mousedown', startBackgroundMusic, true);

                console.log('Event listeners attached. Click or touch screen to start music.');
            } else {
                console.error('‚úó Audio element not found!');
            }

            // Initialize guest name from URL parameters
            const title = getUrlParameter('title') || '';
            let name = getUrlParameter('name') || '';
            name = name.replace(/_/g, ' ');

            // Update form input if guest info is provided
            const fullNameInput = document.querySelector('input[name="H·ªç v√† t√™n"]');
            if (fullNameInput && (title || name)) {
                const guestName = title && name ? title + ' ' + name : (title || name);
                fullNameInput.value = guestName;
                fullNameInput.disabled = true; // Make it read-only
                fullNameInput.style.backgroundColor = '#f9f9f9';
                fullNameInput.style.cursor = 'not-allowed';
            }

            // Update all "b·∫°n" text with title parameter if provided
            if (title) {
                const guestTitle1 = document.getElementById('guest-title-1');
                const guestTitle2 = document.getElementById('guest-title-2');
                const guestTitle3 = document.getElementById('guest-title-3');
                
                if (guestTitle1) guestTitle1.textContent = title;
                if (guestTitle2) guestTitle2.textContent = title;
                if (guestTitle3) guestTitle3.textContent = title;
            }
        });

        // Modal notification functions
        function showNotificationModal() {
            const modal = document.getElementById('notification-modal');
            modal.style.display = 'flex';
            document.getElementById('loading-state').style.display = 'flex';
            document.getElementById('success-state').style.display = 'none';
            document.getElementById('error-state').style.display = 'none';
        }

        function showSuccessModal() {
            document.getElementById('loading-state').style.display = 'none';
            document.getElementById('success-state').style.display = 'flex';
            setTimeout(() => {
                closeNotificationModal();
            }, 3000);
        }

        function showErrorModal(message = 'Vui l√≤ng th·ª≠ l·∫°i') {
            document.getElementById('loading-state').style.display = 'none';
            document.getElementById('error-state').style.display = 'flex';
            document.getElementById('error-message').textContent = message;
        }

        function closeNotificationModal() {
            const modal = document.getElementById('notification-modal');
            modal.style.display = 'none';
        }

        // Add timestamp to form
        function addTimestampToForm() {
            const form = document.getElementById('guest-form');
            if (form) {
                // Create hidden input for timestamp
                let timestampInput = form.querySelector('input[name="Th·ªùi gian submit"]');
                if (!timestampInput) {
                    timestampInput = document.createElement('input');
                    timestampInput.type = 'hidden';
                    timestampInput.name = 'Th·ªùi gian submit';
                    form.appendChild(timestampInput);
                }

                // Set current timestamp
                const now = new Date();
                const timestamp = now.toLocaleString('vi-VN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                timestampInput.value = timestamp;
            }
        }

        // Handle form submission
        const form = document.getElementById('guest-form');
        if (form) {
            form.addEventListener('submit', function (e) {
                addTimestampToForm();
                showNotificationModal();
            });
        }

        // Listen for iframe load to show success
        const iframe = document.getElementById('hidden_iframe');
        if (iframe) {
            iframe.addEventListener('load', function () {
                if (window.submitted) {
                    showSuccessModal();
                    window.submitted = false;
                }
            });
        }

        // Add fade-in animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function (entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(30px)';
            section.style.transition = 'all 0.6s ease-out';
            observer.observe(section);
        });

        // Image loading optimization
        document.addEventListener('DOMContentLoaded', function () {
            // Add fade-in effect for images
            const images = document.querySelectorAll('img[loading="lazy"]');
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.style.opacity = '0';
                        img.style.transition = 'opacity 0.3s ease-in-out';

                        img.onload = function () {
                            img.style.opacity = '1';
                        };

                        // If image is already loaded
                        if (img.complete) {
                            img.style.opacity = '1';
                        }

                        observer.unobserve(img);
                    }
                });
            }, { threshold: 0.1 });

            images.forEach(img => imageObserver.observe(img));
        });

        // QR Code Modal functions
        function showQrModal() {
            // Blur any active input to prevent focus issues
            if (document.activeElement && document.activeElement.blur) {
                document.activeElement.blur();
            }
            
            const modal = document.getElementById('qr-modal');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
            
            // Set focus to close button for better accessibility
            setTimeout(() => {
                const closeBtn = document.getElementById('qr-modal-close');
                if (closeBtn) {
                    closeBtn.focus();
                }
            }, 100);
        }

        function closeQrModal() {
            const modal = document.getElementById('qr-modal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Restore scrolling
        }

        // Handle congratulations button click
        document.addEventListener('DOMContentLoaded', function() {
            const congratulationsBtn = document.getElementById('congratulations-btn');
            const qrModalClose = document.getElementById('qr-modal-close');
            const qrModal = document.getElementById('qr-modal');

            if (congratulationsBtn) {
                congratulationsBtn.addEventListener('click', function(e) {
                    e.preventDefault(); // Prevent default button behavior
                    showQrModal();
                });
            }

            if (qrModalClose) {
                qrModalClose.addEventListener('click', closeQrModal);
            }

            // Close modal when clicking outside
            if (qrModal) {
                qrModal.addEventListener('click', function(e) {
                    if (e.target === qrModal) {
                        closeQrModal();
                    }
                });
            }

            // Close modal with ESC key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && qrModal && qrModal.style.display === 'flex') {
                    closeQrModal();
                }
            });
        });
    </script>
</body>

</html>